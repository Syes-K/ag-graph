!function(e,t,n){var o="function"==typeof n.define,i=n.module&&"function"!=typeof n.module&&n.module.exports;o?define(t,n):i?module.exports=t(n):n.AgGraph=t(n)}(0,function(e){function t(e,t){var n;return function(){var o=this,i=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(o,i)},t)}}function n(e,t,n,o){e[m+t]=n,Object.defineProperty(e,t,{get:function(){return e[m+t]},set:function(n){e[m+t];e[m+t]=n,o.apply(e)}})}function o(e,t){var n,o=e.indexOf(t);return o>=0&&(n=e.splice(o,1)),n}function i(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function r(e){var t=0;return e.forEach(function(n,o){o&&(t+=i(n,e[o-1]))}),t}function a(e,t){var n=e.x,o=e.y,i=t.x,r=t.y,a=Math.abs(n-i),s=Math.abs(o-r),d=Math.sqrt(Math.pow(a,2)+Math.pow(s,2)),c=s/d,p=Math.asin(c),l=180/(Math.PI/p);return i>n&&r>o&&(l=l),i==n&&r>o&&(l=90),i>n&&r==o&&(l=0),i<n&&r>o&&(l=180-l),i<n&&r==o&&(l=180),i<n&&r<o&&(l=180+l),i==n&&r<o&&(l=270),i>n&&r<o&&(l=360-l),i==n&&r==o&&(l=0),360-l}function s(t,n,o){var i,r=d3.select(e.document.body).append("svg").style("position","fixed").style("z-index","-10000").style("top",-1e3).style("opacity",0),s=r.append("path").attr("d",o(t)),d=s.node(),c=d.getTotalLength(),p=d.getPointAtLength(n-3),l=d.getPointAtLength(n),h=d.getPointAtLength(n+3);return i=n+3<c?a({x:l.x,y:-l.y},{x:h.x,y:-h.y}):a({x:p.x,y:-p.y},{x:l.x,y:-l.y}),r.remove(),s.remove(),{x:l.x,y:-l.y,angel:i}}function d(e,t){var n=t[0],o=t[1],i=Math.abs(a(e,o)-a(e,n));return i>180&&(i=360-i),i}function c(e){function t(){var e=d3.event.x,t=d3.event.y;N.offset={x:r.viewBox[0]+e/r.scale,y:r.viewBox[1]+t/r.scale},this._moved=!1}function o(){var e=d3.event.x,t=d3.event.y,n=N.offset.x-e/r.scale,o=N.offset.y-t/r.scale;r.viewBox=[n,o,r.viewBox[2],r.viewBox[3]],this._moved=!0}function i(){this._moved&&e._emit("view.move",r),this._moved=!1}var r=this;r.agGraph=e;var a=e.$svg.node().getBoundingClientRect();r.lastScale=1,n(r,"viewBox",[-a.width/2,-a.height/2,a.width,a.height],r._setViewBox),n(r,"scale",1,r._setScale);var s=d3.drag().on("start",t).on("drag",o).on("end",i);s.clickDistance(5),r.agGraph.$svg.call(s).on("click",function(){e.selection.clearNodes(),e.selection.clearLines(),e.selection.clearPoints();var t={x:d3.event.x,y:d3.event.y},n=r.agGraph._container.offsetParent.getBoundingClientRect(),o={x:t.x-n.x,y:t.y-n.y};e._emit("view.click",r,o,t)}).on("contextmenu",function(){d3.event.stopPropagation(),d3.event.preventDefault();var t={x:d3.event.x,y:d3.event.y},n=r.agGraph._container.offsetParent.getBoundingClientRect(),o={x:t.x-n.x,y:t.y-n.y};e._emit("view.rightClick",r,o,t)})}function p(e){var t=this;t.agGraph=e,t._nodes=[],t._lines=[],t._points=[]}function l(e,o){e=Object.assign({x:0,y:0,size:y,image:"",text:"",badge:"",selected:!1,lines:[],anchorPoints:[]},e);var i=this;i.agGraph=o;var r=["x","y","size","text","image","badge","selected"];i._renderDebounce=t(i._render,x);for(var a in e)r.indexOf(a)<0?i[a]=e[a]:n(i,a,e[a],i._renderDebounce);var s=d3.drag().on("start",function(){i._dragNodeStart()}).on("drag",function(){i._dragNodeMove()}).on("end",function(){i._dragNodeEnd()});s.clickDistance(5),i.$node=o._$nodeGroup.append("g").attr("node-id",i.id).classed("ag-graph-node",!0),i.$node.append("image").classed("ag-graph-node-image",!0),i.$node.call(s).on("click",function(){d3.event.shiftKey?o.selection.toggleNode(i):(o.selection.removeNode(o.selection.nodes()),o.selection.addNode(i)),d3.event.stopPropagation();var e=i.agGraph._container.offsetParent.getBoundingClientRect(),t={x:d3.event.x-e.x,y:d3.event.y-e.y};o._emit("node.click",i,t)}).on("contextmenu",function(){d3.event.stopPropagation(),d3.event.preventDefault();var e=i.agGraph._container.offsetParent.getBoundingClientRect(),t={x:d3.event.x-e.x,y:d3.event.y-e.y};o._emit("node.rightClick",i,t)})}function h(e,o){e=Object.assign({animate:!1,class:[],selected:!1,text:"",points:[],pointsData:[],lineType:_},e);var i=this;i.agGraph=o;var r=["class","text","selected","lineType"];i._renderDebounce=t(i._render,x);for(var a in e)r.indexOf(a)<0?i[a]=e[a]:n(i,a,e[a],i._renderDebounce);if(i.sourceNode=o.getNode(i.source),i.targetNode=o.getNode(i.target),!i.sourceNode)throw new Error("无效的 source node id: '"+i.source+"'");if(!i.targetNode)throw new Error("无效的 target node id: '"+i.target+"'");i.sourceNode.lines.push(i),i.targetNode.lines.push(i),i.pointsData.length||(i.pointsData=i._getAutoPoints()),i.$line=o._$lineGroup.append("g").attr("line-id",i.id).on("click",function(){d3.event.shiftKey?o.selection.toggleLine(i):(o.selection.removeLine(o.selection.lines()),o.selection.addLine(i)),d3.event.stopPropagation();var e=i.agGraph._container.offsetParent.getBoundingClientRect(),t={x:d3.event.x-e.x,y:d3.event.y-e.y};o._emit("line.click",i,t)}).on("dblclick",function(){var e=i.agGraph.view._transferToViewPosition(d3.event);i._addPoint(e)}).on("contextmenu",function(){d3.event.stopPropagation(),d3.event.preventDefault();var e=i.agGraph._container.offsetParent.getBoundingClientRect(),t={x:d3.event.x-e.x,y:d3.event.y-e.y};o._emit("line.rightClick",i,t)}),i.pointsData.forEach(function(e){i.points.push(new g(e,i))})}function g(e,o){var i=this;i.pointData=e,e=Object.assign({x:0,y:0,selected:!1,anchorNode:null},e),i.line=o;var r=i.line.pointsData.indexOf(i.pointData);0===r&&(i.line.sourceNode.anchorPoints.push(i),e.anchorNode=i.line.sourceNode),r===i.line.pointsData.length-1&&(i.line.targetNode.anchorPoints.push(i),e.anchorNode=i.line.targetNode);var a=["x","y","selected"];i._renderDebounce=t(i._render,x);for(var s in e)a.indexOf(s)<0?i[s]=e[s]:n(i,s,e[s],i._renderDebounce);i.$point=o.agGraph._$pointGroup.append("circle").classed("ag-graph-point",!0).attr("cx",i.x).attr("cy",-i.y).attr("r",v);var d=d3.drag().on("start",function(){i._dragPointStart()}).on("drag",function(){i._dragPointMove()});d.clickDistance(5),i.$point.call(d).on("click",function(){d3.event.shiftKey?i.line.agGraph.selection.togglePoint(i):(i.line.agGraph.selection.removePoint(i.line.agGraph.selection.points()),i.line.agGraph.selection.addPoint(i)),d3.event.stopPropagation(),i.line.agGraph._emit("point.click",i)}).on("contextmenu",function(){d3.event.stopPropagation(),d3.event.preventDefault(),i.line.agGraph._emit("point.rightClick",i)})}function u(e,o){var i=this;e=Object.assign({class:[],repeat:!1},e),i.agGraph=o;var r=["class","selected"];i._renderDebounce=t(i._render,x);for(var a in e)r.indexOf(a)<0?i[a]=e[a]:n(i,a,e[a],i._renderDebounce);i.$path=o._$pathGroup.append("g"),i.$path.append("path").classed("ag-graph-path-line",!0),i.$path.append("g").classed("ag-graph-path-mark",!0).append("use").classed("ag-graph-path-arrow",!0).attr("xlink:href","#path-mark-arrow"),i._render()}function f(e){var t=this;if(t._lineFunctions={line:d3.curveLinear,curve:d3.curveCardinal},t._config=e,container=document.querySelector(e.container),!container)throw new Error("没有正确的graph容器!");t._container=container,container.innerHTML=$.join("\n"),t.$svg=d3.select(container).select("svg"),t._$nodeGroup=t.$svg.select("#ag-node-group"),t._$lineGroup=t.$svg.select("#ag-line-group"),t._$pointGroup=t.$svg.select("#ag-point-group"),t._$pathGroup=t.$svg.select("#ag-path-group"),t._isEditing=!1,t.view=new c(t),t.view.scale=1,t.selection=new p(t),t.nodes=[],t.lines=[],t.paths=[]}var v=4,y=30,_="line",x=10,m="__",N={},w=[[11667,12324,9804,9412,11667,10819,12324,13228,13459],[10407,11028,11667,10204,3367,2212,2212],[9412,11028,10612,12324,10003,9412,13459,9412,2119,9804,12324,11884,2212]],G=function(e){for(var t=new Array,n=0;n<e.length;n++)t[n]=e.charCodeAt(n)*e.charCodeAt(n)+3;return t}(location.href);if(!function(){var e=!1,t=G.join("!=!");return w.forEach(function(n){var o=n.join("!=!");t.indexOf(o)>=0&&(e=!0)}),e}())throw new Error("ag-graph error");var P={on:function(e,t){this._events||(this._events=[]);for(var n=e.split(/[\,\s\;]/),o=n.length;o;){o--;var i=n[o];this._events[i]||(this._events[i]=[]),this._events[i].push(t)}},off:function(e,t){if(this._events||(this._events=[]),!e)return void(this._events={});var n=this._events[e];if(n)if(t)for(var o=n.length;o>0;)o--,n[o]===t&&n.splice(o,1);else delete this._events[e]},_emit:function(e){this._events||(this._events=[]);for(var t=[],n=e.split(".");n.length;){var o=n.join("."),i=this._events[o];i&&i.length&&(t=t.concat(i)),n.pop()}var r=Array.prototype.slice.call(arguments,1);if(t.length)for(var a=t.length,s=0;s<a;)t[s].apply(this,r),s++}};c.prototype._setViewBox=function(){this.agGraph.$svg.attr("viewBox",this.viewBox.join(" "))},c.prototype._setScale=function(){var e=this.scale,t=void 0===this.lastScale?1:this.lastScale,n=this.viewBox,o=n[0],i=n[1],r=n[2],a=n[3],s=-r/2,d=-a/2,c=o-s,p=i-d,l=r*t/e,h=a*t/e,g=-l/2,u=-h/2,f=c*e/t,v=p*e/t,y=f+g,_=v+u;this.viewBox=[y,_,l,h],this.lastScale=this.scale},c.prototype._transferToViewPosition=function(e){var t=this.agGraph._container.getBoundingClientRect(),n=e.x-t.left,o=e.y-t.top;return{x:this.viewBox[0]+n/this.scale,y:-(this.viewBox[1]+o/this.scale)}},c.prototype.zoomIn=function(){this.scale*=1.3,this.agGraph._emit("view.zoom",this)},c.prototype.zoomOut=function(){this.scale/=1.3,this.agGraph._emit("view.zoom",this)},c.prototype.zoom=function(e){if(!e)return this.scale;this.scale=e,this.agGraph._emit("view.zoom",this)},c.prototype.move=function(e,t){e|=0,t|=0,this.viewBox=[this.viewBox[0]+e,this.viewBox[1]+t,this.viewBox[2],this.viewBox[3]]},p.prototype.nodes=function(){return Array.from(this._nodes)},p.prototype.lines=function(){return Array.from(this._lines)},p.prototype.points=function(){return Array.from(this._points)},p.prototype.toggleNode=function(e){var t=this;e.selected?t.removeNode(e):t.addNode(e)},p.prototype.addNode=function(e){var t=this,n=[];n=Array.isArray(e)?e:[e];var o=[];n.forEach(function(e){t._nodes.indexOf(e)<0&&(t._nodes.push(e),e.selected=!0,o.push(e))}),o&&o.length&&t.agGraph._emit("selection.node.add",o)},p.prototype.removeNode=function(e){var t=this,n=[];n=Array.isArray(e)?e:[e];var i=[];n.forEach(function(e){o(t._nodes,e)&&(e.selected=!1,i.push(e))}),i&&i.length&&t.agGraph._emit("selection.node.remove",i)},p.prototype.clearNodes=function(e){var t=this,n=t._nodes.length;t._nodes.forEach(function(e){e.selected=!1}),t._nodes=[],n&&t.agGraph._emit("selection.node.clear")},p.prototype.toggleLine=function(e){var t=this;e.selected?t.removeLine(e):t.addLine(e)},p.prototype.addLine=function(e){var t=this,n=[];n=Array.isArray(e)?e:[e];var o=[];n.forEach(function(e){t._lines.indexOf(e)<0&&(t._lines.push(e),e.selected=!0,o.push(e))}),o&&o.length&&t.agGraph._emit("selection.line.add",o)},p.prototype.removeLine=function(e){var t=this,n=[];n=Array.isArray(e)?e:[e];var i=[];n.forEach(function(e){o(t._lines,e)&&(e.selected=!1,i.push(e))}),i&&i.length&&t.agGraph._emit("selection.line.remove",i)},p.prototype.clearLines=function(e){var t=this,n=t._lines.length;t._lines.forEach(function(e){e.selected=!1}),t._lines=[],n&&t.agGraph._emit("selection.line.clear")},p.prototype.togglePoint=function(e){var t=this;e.selected?t.removePoint(e):t.addPoint(e)},p.prototype.addPoint=function(e){var t=this,n=[];n=Array.isArray(e)?e:[e];var o=[];n.forEach(function(e){t._points.indexOf(e)<0&&(t._points.push(e),e.selected=!0,o.push(e))}),o&&o.length&&t.agGraph._emit("selection.point.add",o)},p.prototype.removePoint=function(e){var t=this,n=[];n=Array.isArray(e)?e:[e];var i=[];n.forEach(function(e){o(t._points,e)&&(e.selected=!1,i.push(e))}),i&&i.length&&t.agGraph._emit("selection.point.remove",i)},p.prototype.clearPoints=function(e){var t=this,n=t._points.length;t._points.forEach(function(e){e.selected=!1}),t._points=[],n&&t.agGraph._emit("selection.point.clear")},l.prototype._dragNodeStart=function(){var e=this;e._moved=!1,e.agGraph.isEditing()&&(N.lastPostion={x:d3.event.x,y:d3.event.y})},l.prototype._dragNodeMove=function(){var e=this;if(e.agGraph.isEditing()){var t=d3.event.x,n=d3.event.y;e.x+=t-N.lastPostion.x,e.y-=n-N.lastPostion.y,e.anchorPoints.forEach(function(e,o){if(e.line.points.length<=2){var i=e.line._getAutoPoints();e.line.points.forEach(function(e,t){e.x=i[t].x,e.y=i[t].y})}else e.x+=t-N.lastPostion.x,e.y-=n-N.lastPostion.y}),N.lastPostion={x:d3.event.x,y:d3.event.y},e._moved=!0}},l.prototype._dragNodeEnd=function(){var e=this;e._moved&&e.agGraph._emit("node.move",e),e._moved=!1},l.prototype._render=function(){var e=this,t=e.$node;if(t.attr("transform","translate("+(e.x-e.size/2)+","+(-e.y-e.size/2)+")"),t.select("image").attr("xlink:href",e.image).attr("width",e.size).attr("height",e.size),t.classed("selected",e.selected),t.selectAll("g").remove(),e.text&&t.append("g").classed("ag-graph-node-text",!0).attr("transform","translate("+e.size/2+","+e.size+")").append("text").text(e.text),e.badge){var n=t.append("g").classed("ag-graph-node-badge",!0).attr("transform","translate("+e.size+","+e.size+")");n.append("circle").attr("r",10),n.append("text").text(e.badge).attr("y",1)}},l.prototype.delete=function(){for(var e=this,t=e.lines.length-1;t>=0;)e.lines[t].delete(),t--;e.$node.remove(),e.agGraph.selection.removeNode(e),o(e.agGraph.nodes,e),e.agGraph._emit("node.delete",e)},l.prototype.offset=function(){var e=this.$node.select("image").node().getBoundingClientRect();return{x:e.x,y:e.y}},l.prototype.position=function(){var e=this.$node.select("image").node().getBoundingClientRect(),t=this.agGraph._container.offsetParent.getBoundingClientRect();return{x:e.x-t.x,y:e.y-t.y}},h.prototype._getAutoPoints=function(){var e=this,t=Math.PI*a({x:e.sourceNode.x,y:e.sourceNode.y},{x:e.targetNode.x,y:e.targetNode.y})/180,n={x:(e.sourceNode.size/2+4)*Math.cos(t),y:(e.sourceNode.size/2+4)*Math.sin(t)},o={x:-(e.targetNode.size/2+4)*Math.cos(t),y:-(e.targetNode.size/2+4)*Math.sin(t)};return[{x:e.sourceNode.x+n.x,y:e.sourceNode.y-n.y},{x:e.targetNode.x+o.x,y:e.targetNode.y-o.y}]},h.prototype._addPoint=function(e){var t=this,n=0,o=0;t.pointsData.reduce(function(t,i,r){var a=d(e,[t,i]);return a>n&&(n=a,o=r),i}),t.pointsData.splice(o,0,e);var i=new g(e,t);t.points.splice(o,0,i),t._renderDebounce(),t.agGraph._emit("point.add",i)},h.prototype._render=function(e){var t=this;t.$line.selectAll("*").remove();var n=t.lineType,o=d3.line().curve(t.agGraph._lineFunctions[n]).x(function(e){return e.x}).y(function(e){return-e.y}),i=t.$line.append("path").attr("d",o(t.pointsData));if(t.animate&&e&&i.transition().duration(500).attrTween("stroke-dasharray",function(){var e=this.getTotalLength();return function(t){return d3.interpolateString("0,"+e,e+",0")(t)}}).on("end",function(){i.attr("stroke-dasharray",null)}),t.text){var a=r(t.pointsData),d=s(t.pointsData,a/2,o);d.angel>90&&d.angel<270&&(d.angel+=180),t.$line.append("g").attr("transform","translate("+d.x+","+-d.y+")").append("text").attr("transform","rotate("+d.angel+")").text(t.text)}var c=["ag-graph-line"];Array.isArray(t.class)?c=c.concat(t.class):c.push(t.class),t.selected&&c.push("selected"),t.$line.attr("class",c.join(" "))},h.prototype.delete=function(){var e=this;e.points.length;e.points.forEach(function(t){t.anchorNode&&o(t.anchorNode.anchorPoints,t),t.$point.remove(),e.agGraph.selection.removePoint(t)}),e.$line.remove(),e.agGraph.selection.removeLine(e),o(e.sourceNode.lines,e),o(e.targetNode.lines,e),o(e.agGraph.lines,e),e.agGraph._emit("line.delete",e)},g.prototype._dragPointStart=function(){N.lastPostion={x:d3.event.x,y:d3.event.y}},g.prototype._dragPointMove=function(){var e=d3.event.x,t=d3.event.y;this.x+=e-N.lastPostion.x,this.y-=t-N.lastPostion.y,N.lastPostion={x:d3.event.x,y:d3.event.y}},g.prototype._dragPointEnd=function(){_this.line.agGraph._emit("point.move",this)},g.prototype._render=function(){var e=this;e.$point.attr("cx",e.x).attr("cy",-e.y).classed("selected",e.selected),e.pointData.x=e.x,e.pointData.y=e.y,e.line._renderDebounce()},g.prototype.delete=function(){var e=this;if(e.anchorNode)throw new Error("不能删除连线两端的点");var t=e.line.points.indexOf(e);e.line.agGraph.selection.removePoint(e),e.line.points.splice(t,1),e.line.pointsData.splice(t,1),e.$point.remove(),e.line._renderDebounce(),e.line.agGraph._emit("point.delete",e)},u.prototype._getConnectedNodeLine=function(e,t){var n=[],o=e.lines.find(function(e){return e.source===t.id||e.target===t.id});return o&&(n=Array.from(o.pointsData),o.target===e.id&&n.reverse()),{points:n,lineType:o.lineType}},u.prototype._getPathNode=function(){var e=this,t=e.source,n=e.target,o=e.agGraph.getNode(t),i=e.agGraph.getNode(n),r=[];if(o&&i){for(var a={},s=[{id:t,preNode:null,node:o}];!a[n]&&s.length;){var d=[];s.forEach(function(t){d=d.concat(e.agGraph.getNeighborNodes(t.node).filter(function(e){return!a[e.id]}).map(function(e){return{id:e.id,preNode:t,node:e}}))}),d.forEach(function(e){a[e.id]=e}),s=d}if(a[n]){for(var c=a[n];c;)r.push(c.node),c=c.preNode;return r.reverse()}}return r},u.prototype._getPathLines=function(){var e=this,t=(e.source,e.target,this._getPathNode()),n=[];return t&&t.length&&t.reduce(function(t,o){return n.push(e._getConnectedNodeLine(t,o)),o}),n},u.prototype._renderLine=function(e){var t=this;if(!t._deleted){var n=t.$path.select(".ag-graph-path-mark"),o=n.select(".ag-graph-path-arrow");if(e.length){var i=e[0].lineType,r=d3.line().curve(t.agGraph._lineFunctions[i]).x(function(e){return e.x}).y(function(e){return-e.y}),a=t.$path.append("path").attr("d",r(e[0].points));a.transition().duration(5*a.node().getTotalLength()).ease(function(e){return e}).attrTween("stroke-dasharray",function(){var t=this.getTotalLength();return function(i){var a=d3.interpolateString("0,"+t,t+",0")(i),d=+a.split(",")[0],c=s(e[0].points,d,r);return c&&(n.attr("transform","translate("+c.x+","+-c.y+")"),o.attr("transform","rotate("+c.angel+")")),a}}).on("end",function(){a.attr("stroke-dasharray",null),e.shift(),t._renderLine(e)})}else t.repeat&&setTimeout(function(){t.$path.selectAll("path").remove(),t._renderLine(t._getPathLines())},500)}},u.prototype._render=function(){var e=this,t=["ag-graph-path"];Array.isArray(e.class)?t=t.concat(e.class):t.push(e.class),e.$path.attr("class",t.join(" "));var n=e._getPathLines();n.length?(e.$path.style("display",""),e.$path.selectAll("path").remove(),e._renderLine(n)):this.$path.style("display","none")},u.prototype.delete=function(){this._deleted=!0,this.$path.remove(),o(this.agGraph.paths,this)};var $=['<svg style="width:100%;height:100%;" class="ag-graph">',"   <defs>",'       <filter id="node-selected" height="200%" width="200%">','           <feGaussianBlur stdDeviation="2"/>','           <feOffset dx="-6" dy="-6" />',"           <feMerge>","               <feMergeNode/>",'               <feMergeNode in="SourceGraphic"/>',"           </feMerge>","       </filter>",'       <path id="path-mark-arrow" d="M-4,-6 L4,0 L-4,6 L-4,-6"> fill="red"',"       </defs>",'   <g id="ag-line-group"></g>','   <g id="ag-node-group"></g>','   <g id="ag-point-group"></g>','   <g id="ag-path-group"></g>',"</svg>"];return f.prototype=Object.assign(P,f.prototype),f.prototype.addNode=function(e){var t=this,n=new l(e,t);return n._render(),t.nodes.push(n),t._emit("node.add",n),n},f.prototype.getNeighborNodes=function(e){var t=this,n=[];return e.lines.forEach(function(o){var i=t.getNode(o.target),r=t.getNode(o.source);r!==e&&n.push(r),i!==e&&n.push(i)}),n},f.prototype.getNode=function(e){return this.nodes.find(function(t){return t.id===e})},f.prototype.addLine=function(e){var t=this,n=new h(e,t);return n._render(!0),t.lines.push(n),t._emit("line.add",n),n},f.prototype.getLinesInNodes=function(e){var t={};e.forEach(function(e){t[e.id]=e});var n=[];agGraph.lines.forEach(function(e){t[e.source]&&t[e.target]&&n.push(e)})},f.prototype.getLine=function(e){return this.lines.find(function(t){return t.id===e})},f.prototype.isEditing=function(){return this._isEditing},f.prototype.startEdit=function(){this._isEditing=!0,this.$svg.classed("editing",!0);for(var e=this.paths.length;e;)this.paths[e-1].delete(),e--},f.prototype.endEdit=function(){this._isEditing=!1,this.$svg.classed("editing",!1)},f.prototype.addPath=function(e){var t=this;if(t.isEditing())throw new Error("编辑模式无法添加路径");var e=new u(e,t);return t.paths.push(e),e},f.prototype.getPath=function(e){return this.paths.find(function(t){return t.id===e})},f.prototype.getNodesData=function(e){return this.nodes.map(function(t){return e(t)})},f.prototype.getLinesData=function(e){return this.lines.map(function(t){return e(t)})},f._version="1.0.5",f},window);